(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{27:function(t,e,n){},48:function(t,e,n){"use strict";n.r(e);var r=n(1),c=n.n(r),a=n(21),o=n.n(a),u=(n(27),n(5)),i=n.n(u),s=n(3),l=n.n(s),j=n(6),p=n(12),d=n(22),f=n(4),b=function(){var t=Object(j.a)(l.a.mark((function t(e){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.post("/api/login",e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O={login:b},h="http://localhost:3001/api/notes",m=null,g=function(){var t=Object(j.a)(l.a.mark((function t(e){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={headers:{Authorization:m}},t.next=3,i.a.post(h,e,n);case 3:return r=t.sent,t.abrupt("return",r.data);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v={getAll:function(){return i.a.get(h).then((function(t){return t.data}))},create:g,update:function(t,e){return i.a.put("".concat(h,"/").concat(t),e).then((function(t){return t.data}))},setToken:function(t){m="bearer ".concat(t)}},x=n(0),S=function(t){var e=t.message;return null!==e&&e?Object(x.jsx)("div",{className:"error",children:e}):null},w=function(){return Object(x.jsxs)("div",{style:{color:"green",fontStyle:"italic",fontSize:16},children:[" ",Object(x.jsx)("br",{})," ",Object(x.jsx)("em",{children:"Note app, Department of Computer Science, University of Helsinki 2021"})," "]})},k=function(){var t=Object(r.useState)([]),e=Object(f.a)(t,2),n=e[0],c=e[1],a=Object(r.useState)({}),o=Object(f.a)(a,2),u=o[0],i=o[1],s=Object(r.useState)(!0),b=Object(f.a)(s,2),h=b[0],m=b[1],g=Object(r.useState)(null),k=Object(f.a)(g,2),y=k[0],C=k[1],N=Object(r.useState)(""),E=Object(f.a)(N,2),T=E[0],D=E[1],I=Object(r.useState)(""),J=Object(f.a)(I,2),U=J[0],A=J[1],V=Object(r.useState)(null),z=Object(f.a)(V,2),H=z[0],M=z[1];Object(r.useEffect)((function(){var t=!1;return v.getAll().then((function(e){t||c(e)})).catch((function(t){console.log("kek:",t.message)})),function(){t=!0}}),[]),Object(r.useEffect)((function(){var t=window.localStorage.getItem("loggedNoteappUser");if(t){var e=JSON.parse(t);M(e),v.setToken(e.token)}}),[]);var q=h?n:n.filter((function(t){return t.important})),B=function(t){t.preventDefault(),v.create(u).then((function(t){console.log(t),console.log("submitted OK"),i({content:""}),c([].concat(Object(d.a)(n),[t]))})).catch((function(t){C("".concat(t.response.data)),console.log("<><><>ValidationError",t.response.data,"end//ValidationError")}))},F=function(t){i({id:n.length+1,content:t.target.value,important:Math.random()<.5,date:(new Date).toISOString()}),console.log(t.target.value)},K=function(){var t=Object(j.a)(l.a.mark((function t(e){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.prev=1,t.next=4,O.login({username:T,password:U});case 4:n=t.sent,window.localStorage.setItem("loggedNoteappUser",JSON.stringify(n)),v.setToken(n.token),M(n),D(""),A(""),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),C("Wrong credentials"),setTimeout((function(){C(null)}),5e3);case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsxs)("div",{children:[Object(x.jsx)(S,{message:y}),null===H&&Object(x.jsxs)("form",{onSubmit:K,children:[Object(x.jsxs)("div",{children:["username",Object(x.jsx)("input",{type:"text",value:T,name:"Username",onChange:function(t){var e=t.target;return D(e.value)}})]}),Object(x.jsxs)("div",{children:["password",Object(x.jsx)("input",{type:"password",value:U,name:"Password",onChange:function(t){var e=t.target;return A(e.value)}})]}),Object(x.jsx)("button",{type:"submit",children:"login"})]}),null!==H&&Object(x.jsx)("form",{onSubmit:B,name:"form",children:Object(x.jsx)("input",{type:"text",onChange:F,value:u.content,required:!0})}),null!==H&&Object(x.jsxs)("div",{children:["Hello, ",H.name]}),Object(x.jsx)("button",{type:"button",onClick:function(){m((function(t){return!t}))},children:h?"displaying all":"displaying important"}),Object(x.jsx)("ul",{children:q.map((function(t){return Object(x.jsxs)("li",{children:[Object(x.jsx)("button",{onClick:function(){return function(t){var e=n.find((function(e){return e.id===t})),r=Object(p.a)(Object(p.a)({},e),{},{important:!e.important});v.update(t,r).then((function(e){console.log("resdata",e),c(n.map((function(n){return n.id===t?e:n})))})).catch((function(r){C("the note ".concat(e.content," was already deleted")),setTimeout((function(){C(null)}),5e3),c(n.filter((function(e){return e.id!==t})))}))}(t.id)},children:t.important?"V":Object(x.jsx)(x.Fragment,{children:"\xa0"})})," ",t.content," "]},t.id)}))}),Object(x.jsx)(w,{})]})};o.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(k,{})}),document.getElementById("root"))}},[[48,1,2]]]);
//# sourceMappingURL=main.4149f554.chunk.js.map